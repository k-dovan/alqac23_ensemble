from sentence_transformers import util

from .. import predict

question = "Công dân có chỗ ở hợp pháp thuộc quyền sở hữu của mình thì được đăng ký thường trú tại chỗ ở hợp pháp đó, đúng hay sai?"
question2 = "Công dân có chỗ ở hợp pháp thuộc quyền sở hữu của mình vẫn không được đăng ký thường trú tại chỗ ở hợp pháp đó, đúng hay sai?"

text = "Điều kiện đăng ký thường trú\n\n1. Công dân có chỗ ở hợp pháp thuộc quyền sở hữu của mình thì được đăng ký thường trú tại chỗ ở hợp pháp đó.\n\n2. Công dân được đăng ký thường trú tại chỗ ở hợp pháp không thuộc quyền sở hữu của mình khi được chủ hộ và chủ sở hữu chỗ ở hợp pháp đó đồng ý trong các trường hợp sau đây:\n\na) Vợ về ở với chồng; chồng về ở với vợ; con về ở với cha, mẹ; cha, mẹ về ở với con;\n\nb) Người cao tuổi về ở với anh ruột, chị ruột, em ruột, cháu ruột; người khuyết tật đặc biệt nặng, người khuyết tật nặng, người không có khả năng lao động, người bị bệnh tâm thần hoặc bệnh khác làm mất khả năng nhận thức, khả năng điều khiển hành vi về ở với ông nội, bà nội, ông ngoại, bà ngoại, anh ruột, chị ruột, em ruột, bác ruột, chú ruột, cậu ruột, cô ruột, dì ruột, cháu ruột, người giám hộ;\n\nc) Người chưa thành niên được cha, mẹ hoặc người giám hộ đồng ý hoặc không còn cha, mẹ về ở với cụ nội, cụ ngoại, ông nội, bà nội, ông ngoại, bà ngoại, anh ruột, chị ruột, em ruột, bác ruột, chú ruột, cậu ruột, cô ruột, dì ruột; người chưa thành niên về ở với người giám hộ.\n\n3. Trừ trường hợp quy định tại khoản 2 Điều này, công dân được đăng ký thường trú tại chỗ ở hợp pháp do thuê, mượn, ở nhờ khi đáp ứng các điều kiện sau đây:\n\na) Được chủ sở hữu chỗ ở hợp pháp đồng ý cho đăng ký thường trú tại địa điểm thuê, mượn, ở nhờ và được chủ hộ đồng ý nếu đăng ký thường trú vào cùng hộ gia đình đó;\n\nb) Bảo đảm điều kiện về diện tích nhà ở tối thiểu do Hội đồng nhân dân cấp tỉnh quy định nhưng không thấp hơn 08 m2 sàn/người.\n\n4. Công dân được đăng ký thường trú tại cơ sở tín ngưỡng, cơ sở tôn giáo có công trình phụ trợ là nhà ở khi thuộc một trong các trường hợp sau đây:\n\na) Người hoạt động tôn giáo được phong phẩm, bổ nhiệm, bầu cử, suy cử, thuyên chuyển đến hoạt động tôn giáo tại cơ sở tôn giáo;\n\nb) Người đại diện cơ sở tín ngưỡng;\n\nc) Người được người đại diện hoặc ban quản lý cơ sở tín ngưỡng đồng ý cho đăng ký thường trú để trực tiếp quản lý, tổ chức hoạt động tín ngưỡng tại cơ sở tín ngưỡng;\n\nd) Trẻ em, người khuyết tật đặc biệt nặng, người khuyết tật nặng, người không nơi nương tựa được người đại diện hoặc ban quản lý cơ sở tín ngưỡng, người đứng đầu hoặc người đại diện cơ sở tôn giáo đồng ý cho đăng ký thường trú.\n\n5. Người được chăm sóc, nuôi dưỡng, trợ giúp được đăng ký thường trú tại cơ sở trợ giúp xã hội khi được người đứng đầu cơ sở đó đồng ý hoặc được đăng ký thường trú vào hộ gia đình nhận chăm sóc, nuôi dưỡng khi được chủ hộ và chủ sở hữu chỗ ở hợp pháp đồng ý.\n\n6. Người sinh sống, người làm nghề lưu động trên phương tiện được đăng ký thường trú tại phương tiện đó khi đáp ứng các điều kiện sau đây:\n\na) Là chủ phương tiện hoặc được chủ phương tiện đó đồng ý cho đăng ký thường trú;\n\nb) Phương tiện được đăng ký, đăng kiểm theo quy định của pháp luật; trường hợp phương tiện không thuộc đối tượng phải đăng ký, đăng kiểm thì phải có xác nhận của Ủy ban nhân dân cấp xã nơi phương tiện thường xuyên đậu, đỗ về việc sử dụng phương tiện đó vào mục đích để ở;\n\nc) Có xác nhận của Ủy ban nhân dân cấp xã về việc phương tiện đã đăng ký đậu, đỗ thường xuyên trên địa bàn trong trường hợp phương tiện không phải đăng ký hoặc nơi đăng ký phương tiện không trùng với nơi thường xuyên đậu, đỗ.\n\n7. Việc đăng ký thường trú của người chưa thành niên phải được sự đồng ý của cha, mẹ hoặc người giám hộ, trừ trường hợp nơi cư trú của người chưa thành niên do Tòa án quyết định.\n\n8. Công dân không được đăng ký thường trú mới tại chỗ ở quy định tại Điều 23 của Luật này, trừ trường hợp quy định tại điểm a khoản 2 Điều này."

model = predict.load_models("saved_model", ["mlm_finetuned_vibert_base_cased_all_corpora_ep10"])[0]

context_embed = model.encode(text)
question_embed = model.encode(question)
question_embed2 = model.encode(question2)

print ("score 1: ", util.cos_sim(question_embed, context_embed))
print ("score 2: ", util.cos_sim(question_embed2, context_embed))
